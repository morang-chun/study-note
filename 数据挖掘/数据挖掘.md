# 数据挖掘

```python
import pandas as pd
from sklearn.metrics import r2_score
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression

data = pd.read_csv("../datasets/HousingData.csv")

data.head(5)  #查看数据的前5行

data.tail(5)  #查看后5个数据

data.sample() #查看随机数据

data.iloc[98:99,0:5]  # 查看98到99的数据

data.describe()  #查看数据情况

# 处理缺失值数据：全部删掉
data = data.dropna()
# data.dropna(inplace=Ture)

# 划分数据，划分为训练集，测试集
X=data.drop("MEDV",axis=1)
y=data["MEDV"]
X_train,X_test,y_train,y_test = train_test_split(X,y,train_size=0.7)
lr = LinearRegression()
lr.fit(X_train,y_train)
y_pred = lr.predict(X_test)

import matplotlib.pyplot as plt
plt.plot((y_pred-y_test).values)

r2_score(y_test,y_pred)
mean_squared_error(y_pred,y_test)
lr.intercept_
lr.coef_
```
![image](https://user-images.githubusercontent.com/109726121/188100853-e65d4296-6895-4cea-a622-d99fe5d2a6a3.png)
![image](https://user-images.githubusercontent.com/109726121/188101667-cd48e07b-b60c-4448-815c-ea68d56a25e8.png)


广告投入与销量之间的关系
```python
import pandas as pd
from sklearn.metrics import r2_score
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression

data = pd.read_csv("../datasets/Advertising.csv",index_col="Unnamed: 0")
data.head(2)
data.describe()  #查看数据情况
data.info()
# 划分数据，划分为训练集，测试集
X=data.drop("sales",axis=1)
y=data["sales"]
X_train,X_test,y_train,y_test = train_test_split(X,y,train_size=0.7,random_state=10)
lr = LinearRegression()
lr.fit(X_train,y_train)
y_pred = lr.predict(X_test)
import matplotlib.pyplot as plt
plt.plot((y_pred-y_test).values)   #训练集和测试集的划分是随机的，图像画出来不一样正常
r2_score(y_test,y_pred)
mean_squared_error(y_pred,y_test)
lr.intercept_
lr.coef_

```
![image](https://user-images.githubusercontent.com/109726121/188103878-930d8b8e-c2ba-4223-b404-6e40e3842551.png)


